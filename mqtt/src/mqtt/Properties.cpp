//
// Created by Ivan Kishchenko on 29/09/2019.
//

#include "Properties.h"

#define ARRAY_SIZE(a) (sizeof(a) / sizeof(a[0]))

namespace mqtt {

    struct {
        PropertyCodes value;
        const char *name;
    } nameToString[] = {
            {MQTT_PROPERTY_CODE_PAYLOAD_FORMAT_INDICATOR,           "PAYLOAD_FORMAT_INDICATOR"},
            {MQTT_PROPERTY_CODE_MESSAGE_EXPIRY_INTERVAL,            "MESSAGE_EXPIRY_INTERVAL"},
            {MQTT_PROPERTY_CODE_CONTENT_TYPE,                       "CONTENT_TYPE"},
            {MQTT_PROPERTY_CODE_RESPONSE_TOPIC,                     "RESPONSE_TOPIC"},
            {MQTT_PROPERTY_CODE_CORRELATION_DATA,                   "CORRELATION_DATA"},
            {MQTT_PROPERTY_CODE_SUBSCRIPTION_IDENTIFIER,            "SUBSCRIPTION_IDENTIFIER"},
            {MQTT_PROPERTY_CODE_SESSION_EXPIRY_INTERVAL,            "SESSION_EXPIRY_INTERVAL"},
            {MQTT_PROPERTY_CODE_ASSIGNED_CLIENT_IDENTIFER,          "ASSIGNED_CLIENT_IDENTIFER"},
            {MQTT_PROPERTY_CODE_SERVER_KEEP_ALIVE,                  "SERVER_KEEP_ALIVE"},
            {MQTT_PROPERTY_CODE_AUTHENTICATION_METHOD,              "AUTHENTICATION_METHOD"},
            {MQTT_PROPERTY_CODE_AUTHENTICATION_DATA,                "AUTHENTICATION_DATA"},
            {MQTT_PROPERTY_CODE_REQUEST_PROBLEM_INFORMATION,        "REQUEST_PROBLEM_INFORMATION"},
            {MQTT_PROPERTY_CODE_WILL_DELAY_INTERVAL,                "WILL_DELAY_INTERVAL"},
            {MQTT_PROPERTY_CODE_REQUEST_RESPONSE_INFORMATION,       "REQUEST_RESPONSE_INFORMATION"},
            {MQTT_PROPERTY_CODE_RESPONSE_INFORMATION,               "RESPONSE_INFORMATION"},
            {MQTT_PROPERTY_CODE_SERVER_REFERENCE,                   "SERVER_REFERENCE"},
            {MQTT_PROPERTY_CODE_REASON_STRING,                      "REASON_STRING"},
            {MQTT_PROPERTY_CODE_RECEIVE_MAXIMUM,                    "RECEIVE_MAXIMUM"},
            {MQTT_PROPERTY_CODE_TOPIC_ALIAS_MAXIMUM,                "TOPIC_ALIAS_MAXIMUM"},
            {MQTT_PROPERTY_CODE_TOPIC_ALIAS,                        "TOPIC_ALIAS"},
            {MQTT_PROPERTY_CODE_MAXIMUM_QOS,                        "MAXIMUM_QOS"},
            {MQTT_PROPERTY_CODE_RETAIN_AVAILABLE,                   "RETAIN_AVAILABLE"},
            {MQTT_PROPERTY_CODE_USER_PROPERTY,                      "USER_PROPERTY"},
            {MQTT_PROPERTY_CODE_MAXIMUM_PACKET_SIZE,                "MAXIMUM_PACKET_SIZE"},
            {MQTT_PROPERTY_CODE_WILDCARD_SUBSCRIPTION_AVAILABLE,    "WILDCARD_SUBSCRIPTION_AVAILABLE"},
            {MQTT_PROPERTY_CODE_SUBSCRIPTION_IDENTIFIERS_AVAILABLE, "SUBSCRIPTION_IDENTIFIERS_AVAILABLE"},
            {MQTT_PROPERTY_CODE_SHARED_SUBSCRIPTION_AVAILABLE,      "SHARED_SUBSCRIPTION_AVAILABLE"}
    };

    const char *PropertyName(PropertyCodes value) {
        for (auto &item : nameToString) {
            if (item.value == value) {
                return item.name;
            }
        }
        return nullptr;
    }

    static struct nameToType {
        enum PropertyCodes name;
        enum PropertyTypes type;
    } namesToTypes[] = {
            {MQTT_PROPERTY_CODE_PAYLOAD_FORMAT_INDICATOR,           MQTT_PROPERTY_TYPE_BYTE},
            {MQTT_PROPERTY_CODE_MESSAGE_EXPIRY_INTERVAL,            MQTT_PROPERTY_TYPE_FOUR_BYTE_INTEGER},
            {MQTT_PROPERTY_CODE_CONTENT_TYPE,                       MQTT_PROPERTY_TYPE_UTF_8_ENCODED_STRING},
            {MQTT_PROPERTY_CODE_RESPONSE_TOPIC,                     MQTT_PROPERTY_TYPE_UTF_8_ENCODED_STRING},
            {MQTT_PROPERTY_CODE_CORRELATION_DATA,                   MQTT_PROPERTY_TYPE_BINARY_DATA},
            {MQTT_PROPERTY_CODE_SUBSCRIPTION_IDENTIFIER,            MQTT_PROPERTY_TYPE_VARIABLE_BYTE_INTEGER},
            {MQTT_PROPERTY_CODE_SESSION_EXPIRY_INTERVAL,            MQTT_PROPERTY_TYPE_FOUR_BYTE_INTEGER},
            {MQTT_PROPERTY_CODE_ASSIGNED_CLIENT_IDENTIFER,          MQTT_PROPERTY_TYPE_UTF_8_ENCODED_STRING},
            {MQTT_PROPERTY_CODE_SERVER_KEEP_ALIVE,                  MQTT_PROPERTY_TYPE_TWO_BYTE_INTEGER},
            {MQTT_PROPERTY_CODE_AUTHENTICATION_METHOD,              MQTT_PROPERTY_TYPE_UTF_8_ENCODED_STRING},
            {MQTT_PROPERTY_CODE_AUTHENTICATION_DATA,                MQTT_PROPERTY_TYPE_BINARY_DATA},
            {MQTT_PROPERTY_CODE_REQUEST_PROBLEM_INFORMATION,        MQTT_PROPERTY_TYPE_BYTE},
            {MQTT_PROPERTY_CODE_WILL_DELAY_INTERVAL,                MQTT_PROPERTY_TYPE_FOUR_BYTE_INTEGER},
            {MQTT_PROPERTY_CODE_REQUEST_RESPONSE_INFORMATION,       MQTT_PROPERTY_TYPE_BYTE},
            {MQTT_PROPERTY_CODE_RESPONSE_INFORMATION,               MQTT_PROPERTY_TYPE_UTF_8_ENCODED_STRING},
            {MQTT_PROPERTY_CODE_SERVER_REFERENCE,                   MQTT_PROPERTY_TYPE_UTF_8_ENCODED_STRING},
            {MQTT_PROPERTY_CODE_REASON_STRING,                      MQTT_PROPERTY_TYPE_UTF_8_ENCODED_STRING},
            {MQTT_PROPERTY_CODE_RECEIVE_MAXIMUM,                    MQTT_PROPERTY_TYPE_TWO_BYTE_INTEGER},
            {MQTT_PROPERTY_CODE_TOPIC_ALIAS_MAXIMUM,                MQTT_PROPERTY_TYPE_TWO_BYTE_INTEGER},
            {MQTT_PROPERTY_CODE_TOPIC_ALIAS,                        MQTT_PROPERTY_TYPE_TWO_BYTE_INTEGER},
            {MQTT_PROPERTY_CODE_MAXIMUM_QOS,                        MQTT_PROPERTY_TYPE_BYTE},
            {MQTT_PROPERTY_CODE_RETAIN_AVAILABLE,                   MQTT_PROPERTY_TYPE_BYTE},
            {MQTT_PROPERTY_CODE_USER_PROPERTY,                      MQTT_PROPERTY_TYPE_UTF_8_STRING_PAIR},
            {MQTT_PROPERTY_CODE_MAXIMUM_PACKET_SIZE,                MQTT_PROPERTY_TYPE_FOUR_BYTE_INTEGER},
            {MQTT_PROPERTY_CODE_WILDCARD_SUBSCRIPTION_AVAILABLE,    MQTT_PROPERTY_TYPE_BYTE},
            {MQTT_PROPERTY_CODE_SUBSCRIPTION_IDENTIFIERS_AVAILABLE, MQTT_PROPERTY_TYPE_BYTE},
            {MQTT_PROPERTY_CODE_SHARED_SUBSCRIPTION_AVAILABLE,      MQTT_PROPERTY_TYPE_BYTE}
    };

    int PropertyType(PropertyCodes value) {
        int rc = -1;

        for (auto &item : namesToTypes) {
            if (item.name == value) {
                return item.type;
            }
        }

        return rc;
    }
}